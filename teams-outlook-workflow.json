{
  "name": "ğŸ¤– Teams Outlook Email & Calendar Manager",
  "active": true,
  "nodes": [
    {
      "parameters": {
        "path": "teams-outlook-assistant",
        "httpMethod": "POST",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-001",
      "name": "ğŸ¯ Teams Bot Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [240, 300],
      "webhookId": "teams-outlook-assistant"
    },
    {
      "parameters": {
        "resource": "chat",
        "operation": "complete",
        "modelId": "gpt-4",
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "You are an expert assistant that parses natural language requests for email and calendar management. Extract the intent and parameters from user messages.\n\nAvailable intents:\n- SUMMARIZE_EMAIL: Summarize unread emails or specific threads\n- COMPOSE_EMAIL: Create and send emails\n- SCHEDULE_EVENT: Create calendar events\n- RESCHEDULE_EVENT: Modify existing events\n- MANAGE_DRAFT: Work with email drafts\n- FOLLOW_UP: Set reminders\n\nReturn JSON with:\n{\n  \"intent\": \"<intent_name>\",\n  \"parameters\": {\n    \"subject\": \"<subject if applicable>\",\n    \"recipient\": \"<email address>\",\n    \"date\": \"<date in ISO format>\",\n    \"message\": \"<message content>\",\n    \"attachment\": \"<file name>\",\n    \"search_terms\": \"<keywords for search>\",\n    \"urgency\": \"<high|medium|low>\",\n    \"confidence\": \"<0-100>\"\n  },\n  \"clarification_needed\": \"<question if unclear>\"\n}"
            },
            {
              "role": "user",
              "content": "={{ $json.text || $json.message || $json.content }}"
            }
          ]
        },
        "options": {
          "maxTokens": 500,
          "temperature": 0.1
        }
      },
      "id": "ai-parser-001",
      "name": "ğŸ§  AI Intent Parser",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 1.1,
      "position": [480, 300]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "operation": "equal"
          },
          "conditions": [
            {
              "id": "intent-summarize",
              "leftValue": "={{ JSON.parse($json.choices[0].message.content).intent }}",
              "rightValue": "SUMMARIZE_EMAIL",
              "operation": "equal"
            },
            {
              "id": "intent-compose",
              "leftValue": "={{ JSON.parse($json.choices[0].message.content).intent }}",
              "rightValue": "COMPOSE_EMAIL",
              "operation": "equal"
            },
            {
              "id": "intent-schedule",
              "leftValue": "={{ JSON.parse($json.choices[0].message.content).intent }}",
              "rightValue": "SCHEDULE_EVENT",
              "operation": "equal"
            },
            {
              "id": "intent-draft",
              "leftValue": "={{ JSON.parse($json.choices[0].message.content).intent }}",
              "rightValue": "MANAGE_DRAFT",
              "operation": "equal"
            }
          ],
          "combineOperation": "any"
        },
        "options": {}
      },
      "id": "intent-router-001",
      "name": "ğŸ”€ Intent Router",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [720, 300]
    },
    {
      "parameters": {
        "resource": "folderMessage",
        "operation": "getAll",
        "folderId": {
          "mode": "list",
          "value": "inbox"
        },
        "limit": 10,
        "filters": {
          "isRead": false
        }
      },
      "id": "outlook-get-unread",
      "name": "ğŸ“§ Get Unread Emails",
      "type": "n8n-nodes-base.microsoftOutlook",
      "typeVersion": 2,
      "position": [960, 100]
    },
    {
      "parameters": {
        "resource": "chat",
        "operation": "complete",
        "modelId": "gpt-4",
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "You are an expert email summarizer. Create a concise, professional summary of the provided emails. Focus on:\n- Sender and subject\n- Key points and action items\n- Urgency level\n- Recommended actions\n\nFormat as a clear, actionable summary suitable for a business owner."
            },
            {
              "role": "user",
              "content": "Please summarize these emails:\n\n={{ $json.map(email => `From: ${email.sender.emailAddress.name} <${email.sender.emailAddress.address}>\nSubject: ${email.subject}\nReceived: ${email.receivedDateTime}\nPreview: ${email.bodyPreview}\n\n`).join('') }}"
            }
          ]
        },
        "options": {
          "maxTokens": 800,
          "temperature": 0.3
        }
      },
      "id": "ai-summarizer-001",
      "name": "ğŸ“ AI Email Summarizer",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 1.1,
      "position": [1200, 100]
    },
    {
      "parameters": {
        "resource": "chatMessage",
        "operation": "sendAndWait",
        "chatId": {
          "mode": "expression",
          "value": "={{ $('ğŸ¯ Teams Bot Webhook').item.json.chatId }}"
        },
        "message": "## ğŸ“§ Email Summary\n\n{{ $json.choices[0].message.content }}\n\n---\n*What would you like to do next?*",
        "options": {
          "attachments": [
            {
              "content": {
                "type": "AdaptiveCard",
                "version": "1.3",
                "body": [
                  {
                    "type": "TextBlock",
                    "text": "Email Actions",
                    "weight": "Bolder",
                    "size": "Medium"
                  },
                  {
                    "type": "ActionSet",
                    "actions": [
                      {
                        "type": "Action.Submit",
                        "title": "ğŸ“¬ Get More Details",
                        "data": {
                          "action": "get_details"
                        }
                      },
                      {
                        "type": "Action.Submit",
                        "title": "âœ‰ï¸ Compose Reply",
                        "data": {
                          "action": "compose_reply"
                        }
                      },
                      {
                        "type": "Action.Submit",
                        "title": "ğŸ—“ï¸ Schedule Follow-up",
                        "data": {
                          "action": "schedule_followup"
                        }
                      }
                    ]
                  }
                ]
              },
              "name": "email-actions.json",
              "contentType": "application/vnd.microsoft.card.adaptive"
            }
          ]
        }
      },
      "id": "teams-summarize-response",
      "name": "ğŸ“± Teams Summary Response",
      "type": "n8n-nodes-base.microsoftTeams",
      "typeVersion": 2,
      "position": [1440, 100]
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "send",
        "toRecipients": "={{ JSON.parse($('ğŸ§  AI Intent Parser').item.json.choices[0].message.content).parameters.recipient }}",
        "subject": "={{ JSON.parse($('ğŸ§  AI Intent Parser').item.json.choices[0].message.content).parameters.subject }}",
        "bodyContent": "={{ JSON.parse($('ğŸ§  AI Intent Parser').item.json.choices[0].message.content).parameters.message }}",
        "options": {}
      },
      "id": "outlook-compose-email",
      "name": "âœ‰ï¸ Compose & Send Email",
      "type": "n8n-nodes-base.microsoftOutlook",
      "typeVersion": 2,
      "position": [960, 200]
    },
    {
      "parameters": {
        "resource": "chatMessage",
        "operation": "create",
        "chatId": {
          "mode": "expression",
          "value": "={{ $('ğŸ¯ Teams Bot Webhook').item.json.chatId }}"
        },
        "contentType": "text",
        "message": "## âœ‰ï¸ Email Sent Successfully!\n\n**To:** {{ JSON.parse($('ğŸ§  AI Intent Parser').item.json.choices[0].message.content).parameters.recipient }}\n**Subject:** {{ JSON.parse($('ğŸ§  AI Intent Parser').item.json.choices[0].message.content).parameters.subject }}\n\nâœ… Your email has been sent successfully!"
      },
      "id": "teams-compose-response",
      "name": "ğŸ“± Teams Compose Response",
      "type": "n8n-nodes-base.microsoftTeams",
      "typeVersion": 2,
      "position": [1200, 200]
    },
    {
      "parameters": {
        "resource": "event",
        "operation": "create",
        "calendarId": {
          "mode": "list",
          "value": "calendar"
        },
        "subject": "={{ JSON.parse($('ğŸ§  AI Intent Parser').item.json.choices[0].message.content).parameters.subject }}",
        "startDateTime": "={{ JSON.parse($('ğŸ§  AI Intent Parser').item.json.choices[0].message.content).parameters.date }}",
        "endDateTime": "={{ DateTime.fromISO(JSON.parse($('ğŸ§  AI Intent Parser').item.json.choices[0].message.content).parameters.date).plus({hours: 1}).toISO() }}",
        "options": {
          "body": "={{ JSON.parse($('ğŸ§  AI Intent Parser').item.json.choices[0].message.content).parameters.message }}"
        }
      },
      "id": "outlook-create-event",
      "name": "ğŸ—“ï¸ Create Calendar Event",
      "type": "n8n-nodes-base.microsoftOutlook",
      "typeVersion": 2,
      "position": [960, 300]
    },
    {
      "parameters": {
        "resource": "chatMessage",
        "operation": "create",
        "chatId": {
          "mode": "expression",
          "value": "={{ $('ğŸ¯ Teams Bot Webhook').item.json.chatId }}"
        },
        "contentType": "text",
        "message": "## ğŸ—“ï¸ Calendar Event Created!\n\n**Event:** {{ $json.subject }}\n**Date:** {{ $json.start.dateTime }}\n**Duration:** 1 hour\n\nâœ… Your calendar event has been created successfully!"
      },
      "id": "teams-schedule-response",
      "name": "ğŸ“± Teams Schedule Response",
      "type": "n8n-nodes-base.microsoftTeams",
      "typeVersion": 2,
      "position": [1200, 300]
    },
    {
      "parameters": {
        "resource": "draft",
        "operation": "getAll",
        "limit": 10
      },
      "id": "outlook-get-drafts",
      "name": "ğŸ“ Get Email Drafts",
      "type": "n8n-nodes-base.microsoftOutlook",
      "typeVersion": 2,
      "position": [960, 400]
    },
    {
      "parameters": {
        "resource": "chatMessage",
        "operation": "create",
        "chatId": {
          "mode": "expression",
          "value": "={{ $('ğŸ¯ Teams Bot Webhook').item.json.chatId }}"
        },
        "contentType": "text",
        "message": "## ğŸ“ Your Email Drafts\n\n{{ $json.length ? $json.map((draft, index) => `${index + 1}. **${draft.subject || 'No Subject'}**\\n   ğŸ“§ To: ${draft.toRecipients?.map(r => r.emailAddress.address).join(', ') || 'No Recipients'}\\n   ğŸ“… Modified: ${draft.lastModifiedDateTime}\\n`).join('\\n') : 'No drafts found.' }}"
      },
      "id": "teams-draft-response",
      "name": "ğŸ“± Teams Draft Response",
      "type": "n8n-nodes-base.microsoftTeams",
      "typeVersion": 2,
      "position": [1200, 400]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ { \"status\": \"success\", \"message\": \"Request processed successfully\", \"timestamp\": new Date().toISOString() } }}"
      },
      "id": "webhook-response",
      "name": "âœ… Webhook Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [1440, 300]
    }
  ],
  "connections": {
    "ğŸ¯ Teams Bot Webhook": {
      "main": [
        [
          {
            "node": "ğŸ§  AI Intent Parser",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ§  AI Intent Parser": {
      "main": [
        [
          {
            "node": "ğŸ”€ Intent Router",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”€ Intent Router": {
      "main": [
        [
          {
            "node": "ğŸ“§ Get Unread Emails",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âœ‰ï¸ Compose & Send Email",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸ—“ï¸ Create Calendar Event",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸ“ Get Email Drafts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“§ Get Unread Emails": {
      "main": [
        [
          {
            "node": "ğŸ“ AI Email Summarizer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ AI Email Summarizer": {
      "main": [
        [
          {
            "node": "ğŸ“± Teams Summary Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Teams Summary Response": {
      "main": [
        [
          {
            "node": "âœ… Webhook Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ‰ï¸ Compose & Send Email": {
      "main": [
        [
          {
            "node": "ğŸ“± Teams Compose Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Teams Compose Response": {
      "main": [
        [
          {
            "node": "âœ… Webhook Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ—“ï¸ Create Calendar Event": {
      "main": [
        [
          {
            "node": "ğŸ“± Teams Schedule Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Teams Schedule Response": {
      "main": [
        [
          {
            "node": "âœ… Webhook Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“ Get Email Drafts": {
      "main": [
        [
          {
            "node": "ğŸ“± Teams Draft Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“± Teams Draft Response": {
      "main": [
        [
          {
            "node": "âœ… Webhook Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-07-05T13:59:07.000Z",
  "versionId": "1"
}
